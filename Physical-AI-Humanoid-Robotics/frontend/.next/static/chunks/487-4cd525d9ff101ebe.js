(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[487],{3454:function(e,t,n){"use strict";var r,o;e.exports=(null==(r=n.g.process)?void 0:r.env)&&"object"==typeof(null==(o=n.g.process)?void 0:o.env)?n.g.process:n(7663)},8199:function(e,t){"use strict";var n,r,o,i;Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var n in t)Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}(t,{ACTION_FAST_REFRESH:function(){return f},ACTION_NAVIGATE:function(){return l},ACTION_PREFETCH:function(){return c},ACTION_REFRESH:function(){return s},ACTION_RESTORE:function(){return u},ACTION_SERVER_ACTION:function(){return d},ACTION_SERVER_PATCH:function(){return a},PrefetchCacheEntryStatus:function(){return r},PrefetchKind:function(){return n},isThenable:function(){return p}});let s="refresh",l="navigate",u="restore",a="server-patch",c="prefetch",f="fast-refresh",d="server-action";function p(e){return e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof e.then}(o=n||(n={})).AUTO="auto",o.FULL="full",o.TEMPORARY="temporary",(i=r||(r={})).fresh="fresh",i.reusable="reusable",i.expired="expired",i.stale="stale",("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},7195:function(e,t,n){"use strict";function r(e,t,n,r){return!1}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"getDomainLocale",{enumerable:!0,get:function(){return r}}),n(8337),("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},8342:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return T}});let r=n(8754),o=n(5893),i=r._(n(7294)),s=n(6075),l=n(3955),u=n(8041),a=n(9903),c=n(5490),f=n(1928),d=n(257),p=n(4229),h=n(7195),v=n(9470),y=n(8199),b=new Set;function g(e,t,n,r,o,i){if(i||(0,l.isLocalURL)(t)){if(!r.bypassPrefetchedCheck){let o=t+"%"+n+"%"+(void 0!==r.locale?r.locale:"locale"in e?e.locale:void 0);if(b.has(o))return;b.add(o)}(async()=>i?e.prefetch(t,o):e.prefetch(t,n,r))().catch(e=>{})}}function m(e){return"string"==typeof e?e:(0,u.formatUrl)(e)}let T=i.default.forwardRef(function(e,t){let n,r;let{href:u,as:b,children:T,prefetch:w=null,passHref:E,replace:R,shallow:O,scroll:_,locale:S,onClick:L,onMouseEnter:A,onTouchStart:I,legacyBehavior:x=!1,...P}=e;n=T,x&&("string"==typeof n||"number"==typeof n)&&(n=(0,o.jsx)("a",{children:n}));let C=i.default.useContext(f.RouterContext),U=i.default.useContext(d.AppRouterContext),j=null!=C?C:U,N=!C,M=!1!==w,k=null===w?y.PrefetchKind.AUTO:y.PrefetchKind.FULL,{href:$,as:B}=i.default.useMemo(()=>{if(!C){let e=m(u);return{href:e,as:b?m(b):e}}let[e,t]=(0,s.resolveHref)(C,u,!0);return{href:e,as:b?(0,s.resolveHref)(C,b):t||e}},[C,u,b]),D=i.default.useRef($),q=i.default.useRef(B);x&&(r=i.default.Children.only(n));let F=x?r&&"object"==typeof r&&r.ref:t,[H,V,G]=(0,p.useIntersection)({rootMargin:"200px"}),W=i.default.useCallback(e=>{(q.current!==B||D.current!==$)&&(G(),q.current=B,D.current=$),H(e),F&&("function"==typeof F?F(e):"object"==typeof F&&(F.current=e))},[B,F,$,G,H]);i.default.useEffect(()=>{j&&V&&M&&g(j,$,B,{locale:S},{kind:k},N)},[B,$,V,S,M,null==C?void 0:C.locale,j,N,k]);let Y={ref:W,onClick(e){x||"function"!=typeof L||L(e),x&&r.props&&"function"==typeof r.props.onClick&&r.props.onClick(e),j&&!e.defaultPrevented&&function(e,t,n,r,o,s,u,a,c){let{nodeName:f}=e.currentTarget;if("A"===f.toUpperCase()&&(function(e){let t=e.currentTarget.getAttribute("target");return t&&"_self"!==t||e.metaKey||e.ctrlKey||e.shiftKey||e.altKey||e.nativeEvent&&2===e.nativeEvent.which}(e)||!c&&!(0,l.isLocalURL)(n)))return;e.preventDefault();let d=()=>{let e=null==u||u;"beforePopState"in t?t[o?"replace":"push"](n,r,{shallow:s,locale:a,scroll:e}):t[o?"replace":"push"](r||n,{scroll:e})};c?i.default.startTransition(d):d()}(e,j,$,B,R,O,_,S,N)},onMouseEnter(e){x||"function"!=typeof A||A(e),x&&r.props&&"function"==typeof r.props.onMouseEnter&&r.props.onMouseEnter(e),j&&(M||!N)&&g(j,$,B,{locale:S,priority:!0,bypassPrefetchedCheck:!0},{kind:k},N)},onTouchStart:function(e){x||"function"!=typeof I||I(e),x&&r.props&&"function"==typeof r.props.onTouchStart&&r.props.onTouchStart(e),j&&(M||!N)&&g(j,$,B,{locale:S,priority:!0,bypassPrefetchedCheck:!0},{kind:k},N)}};if((0,a.isAbsoluteUrl)(B))Y.href=B;else if(!x||E||"a"===r.type&&!("href"in r.props)){let e=void 0!==S?S:null==C?void 0:C.locale,t=(null==C?void 0:C.isLocaleDomain)&&(0,h.getDomainLocale)(B,e,null==C?void 0:C.locales,null==C?void 0:C.domainLocales);Y.href=t||(0,v.addBasePath)((0,c.addLocale)(B,e,null==C?void 0:C.defaultLocale))}return x?i.default.cloneElement(r,Y):(0,o.jsx)("a",{...P,...Y,children:n})});("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},4229:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"useIntersection",{enumerable:!0,get:function(){return u}});let r=n(7294),o=n(4474),i="function"==typeof IntersectionObserver,s=new Map,l=[];function u(e){let{rootRef:t,rootMargin:n,disabled:u}=e,a=u||!i,[c,f]=(0,r.useState)(!1),d=(0,r.useRef)(null),p=(0,r.useCallback)(e=>{d.current=e},[]);return(0,r.useEffect)(()=>{if(i){if(a||c)return;let e=d.current;if(e&&e.tagName)return function(e,t,n){let{id:r,observer:o,elements:i}=function(e){let t;let n={root:e.root||null,margin:e.rootMargin||""},r=l.find(e=>e.root===n.root&&e.margin===n.margin);if(r&&(t=s.get(r)))return t;let o=new Map;return t={id:n,observer:new IntersectionObserver(e=>{e.forEach(e=>{let t=o.get(e.target),n=e.isIntersecting||e.intersectionRatio>0;t&&n&&t(n)})},e),elements:o},l.push(n),s.set(n,t),t}(n);return i.set(e,t),o.observe(e),function(){if(i.delete(e),o.unobserve(e),0===i.size){o.disconnect(),s.delete(r);let e=l.findIndex(e=>e.root===r.root&&e.margin===r.margin);e>-1&&l.splice(e,1)}}}(e,e=>e&&f(e),{root:null==t?void 0:t.current,rootMargin:n})}else if(!c){let e=(0,o.requestIdleCallback)(()=>f(!0));return()=>(0,o.cancelIdleCallback)(e)}},[a,n,t,c,d.current]),[p,c,(0,r.useCallback)(()=>{f(!1)},[])]}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},7663:function(e){!function(){var t={229:function(e){var t,n,r,o=e.exports={};function i(){throw Error("setTimeout has not been defined")}function s(){throw Error("clearTimeout has not been defined")}function l(e){if(t===setTimeout)return setTimeout(e,0);if((t===i||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:i}catch(e){t=i}try{n="function"==typeof clearTimeout?clearTimeout:s}catch(e){n=s}}();var u=[],a=!1,c=-1;function f(){a&&r&&(a=!1,r.length?u=r.concat(u):c=-1,u.length&&d())}function d(){if(!a){var e=l(f);a=!0;for(var t=u.length;t;){for(r=u,u=[];++c<t;)r&&r[c].run();c=-1,t=u.length}r=null,a=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===s||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function h(){}o.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new p(e,t)),1!==u.length||a||l(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=h,o.addListener=h,o.once=h,o.off=h,o.removeListener=h,o.removeAllListeners=h,o.emit=h,o.prependListener=h,o.prependOnceListener=h,o.listeners=function(e){return[]},o.binding=function(e){throw Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw Error("process.chdir is not supported")},o.umask=function(){return 0}}},n={};function r(e){var o=n[e];if(void 0!==o)return o.exports;var i=n[e]={exports:{}},s=!0;try{t[e](i,i.exports,r),s=!1}finally{s&&delete n[e]}return i.exports}r.ab="//";var o=r(229);e.exports=o}()},9008:function(e,t,n){e.exports=n(3867)},1664:function(e,t,n){e.exports=n(8342)},3784:function(e,t,n){"use strict";n.d(t,{XL:function(){return ep}});let r=Symbol.for("better-auth:broadcast-channel"),o=()=>Math.floor(Date.now()/1e3);var i=class{listeners=new Set;name;constructor(e="better-auth.message"){this.name=e}subscribe(e){return this.listeners.add(e),()=>{this.listeners.delete(e)}}post(e){if("undefined"!=typeof window)try{localStorage.setItem(this.name,JSON.stringify({...e,timestamp:o()}))}catch{}}setup(){if("undefined"==typeof window||void 0===window.addEventListener)return()=>{};let e=e=>{if(e.key!==this.name)return;let t=JSON.parse(e.newValue??"{}");t?.event==="session"&&t?.data&&this.listeners.forEach(e=>e(t))};return window.addEventListener("storage",e),()=>{window.removeEventListener("storage",e)}}};function s(e="better-auth.message"){return globalThis[r]||(globalThis[r]=new i(e)),globalThis[r]}let l=Symbol.for("better-auth:focus-manager");var u=class{listeners=new Set;subscribe(e){return this.listeners.add(e),()=>{this.listeners.delete(e)}}setFocused(e){this.listeners.forEach(t=>t(e))}setup(){if("undefined"==typeof window||"undefined"==typeof document||void 0===window.addEventListener)return()=>{};let e=()=>{"visible"===document.visibilityState&&this.setFocused(!0)};return document.addEventListener("visibilitychange",e,!1),()=>{document.removeEventListener("visibilitychange",e,!1)}}};function a(){return globalThis[l]||(globalThis[l]=new u),globalThis[l]}let c=Symbol.for("better-auth:online-manager");var f=class{listeners=new Set;isOnline="undefined"==typeof navigator||navigator.onLine;subscribe(e){return this.listeners.add(e),()=>{this.listeners.delete(e)}}setOnline(e){this.isOnline=e,this.listeners.forEach(t=>t(e))}setup(){if("undefined"==typeof window||void 0===window.addEventListener)return()=>{};let e=()=>this.setOnline(!0),t=()=>this.setOnline(!1);return window.addEventListener("online",e,!1),window.addEventListener("offline",t,!1),()=>{window.removeEventListener("online",e,!1),window.removeEventListener("offline",t,!1)}}};function d(){return globalThis[c]||(globalThis[c]=new f),globalThis[c]}let p=()=>Math.floor(Date.now()/1e3);var h=n(3454);let v=Object.create(null),y=e=>globalThis.process?.env||globalThis.Deno?.env.toObject()||globalThis.__env__||(e?v:globalThis),b=new Proxy(v,{get:(e,t)=>y()[t]??v[t],has:(e,t)=>t in y()||t in v,set:(e,t,n)=>(y(!0)[t]=n,!0),deleteProperty(e,t){if(!t)return!1;let n=y(!0);return delete n[t],!0},ownKeys:()=>Object.keys(y(!0))});function g(e,t){return void 0!==h&&h.env?h.env[e]??t:"undefined"!=typeof Deno?Deno.env.get(e)??t:"undefined"!=typeof Bun?Bun.env[e]??t:t}void 0!==h&&h.env,Object.freeze({get BETTER_AUTH_SECRET(){return g("BETTER_AUTH_SECRET")},get AUTH_SECRET(){return g("AUTH_SECRET")},get BETTER_AUTH_TELEMETRY(){return g("BETTER_AUTH_TELEMETRY")},get BETTER_AUTH_TELEMETRY_ID(){return g("BETTER_AUTH_TELEMETRY_ID")},get NODE_ENV(){return g("NODE_ENV","development")},get PACKAGE_VERSION(){return g("PACKAGE_VERSION","0.0.0")},get BETTER_AUTH_TELEMETRY_ENDPOINT(){return g("BETTER_AUTH_TELEMETRY_ENDPOINT","https://telemetry.better-auth.com/v1/track")}});let m={eterm:4,cons25:4,console:4,cygwin:4,dtterm:4,gnome:4,hurd:4,jfbterm:4,konsole:4,kterm:4,mlterm:4,mosh:24,putty:4,st:4,"rxvt-unicode-24bit":24,terminator:24,"xterm-kitty":24},T=new Map(Object.entries({APPVEYOR:8,BUILDKITE:8,CIRCLECI:24,DRONE:8,GITEA_ACTIONS:24,GITHUB_ACTIONS:24,GITLAB_CI:8,TRAVIS:8})),w=[/ansi/,/color/,/linux/,/direct/,/^con[0-9]*x[0-9]/,/^rxvt/,/^screen/,/^xterm/,/^vt100/,/^vt220/],E={reset:"\x1b[0m",bright:"\x1b[1m",dim:"\x1b[2m",fg:{black:"\x1b[30m",red:"\x1b[31m",green:"\x1b[32m",yellow:"\x1b[33m",blue:"\x1b[34m",magenta:"\x1b[35m",cyan:"\x1b[36m",white:"\x1b[37m"}},R=["debug","info","success","warn","error"],O={info:E.fg.blue,success:E.fg.green,warn:E.fg.yellow,error:E.fg.red,debug:E.fg.magenta},_=(e,t,n)=>{let r=new Date().toISOString();return n?`${E.dim}${r}${E.reset} ${O[e]}${e.toUpperCase()}${E.reset} ${E.bright}[Better Auth]:${E.reset} ${t}`:`${r} ${e.toUpperCase()} [Better Auth]: ${t}`};(e=>{let t=e?.disabled!==!0,n=e?.level??"error",r=e?.disableColors!==void 0?!e.disableColors:1!==function(){if(void 0!==g("FORCE_COLOR"))switch(g("FORCE_COLOR")){case"":case"1":case"true":return 4;case"2":return 8;case"3":return 24;default:return 1}if(void 0!==g("NODE_DISABLE_COLORS")&&""!==g("NODE_DISABLE_COLORS")||void 0!==g("NO_COLOR")&&""!==g("NO_COLOR")||"dumb"===g("TERM"))return 1;if(g("TMUX"))return 24;if("TF_BUILD"in b&&"AGENT_NAME"in b)return 4;if("CI"in b){for(let{0:e,1:t}of T)if(e in b)return t;return"codeship"===g("CI_NAME")?8:1}if("TEAMCITY_VERSION"in b)return null!==/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.exec(g("TEAMCITY_VERSION"))?4:1;switch(g("TERM_PROGRAM")){case"iTerm.app":if(!g("TERM_PROGRAM_VERSION")||null!==/^[0-2]\./.exec(g("TERM_PROGRAM_VERSION")))return 8;return 24;case"HyperTerm":case"MacTerm":return 24;case"Apple_Terminal":return 8}if("truecolor"===g("COLORTERM")||"24bit"===g("COLORTERM"))return 24;if(g("TERM")){if(null!==/truecolor/.exec(g("TERM")))return 24;if(null!==/^xterm-256/.exec(g("TERM")))return 8;let e=g("TERM").toLowerCase();if(m[e])return m[e];if(w.some(t=>null!==t.exec(e)))return 4}return g("COLORTERM")?4:1}(),o=(o,i,s=[])=>{if(!t||!(R.indexOf(o)>=R.indexOf(n)))return;let l=_(o,i,r);if(!e||"function"!=typeof e.log){"error"===o?console.error(l,...s):"warn"===o?console.warn(l,...s):console.log(l,...s);return}e.log("success"===o?"info":o,i,...s)};return{...Object.fromEntries(R.map(e=>[e,(...[t,...n])=>o(e,t,n)])),get level(){return n}}})();var S=class extends Error{constructor(e,t){super(e),this.name="BetterAuthError",this.message=e,this.cause=t,this.stack=""}};function L(e,t="/api/auth"){if(!function(e){try{let t=new URL(e);if("http:"!==t.protocol&&"https:"!==t.protocol)throw new S(`Invalid base URL: ${e}. URL must include 'http://' or 'https://'`)}catch(t){if(t instanceof S)throw t;throw new S(`Invalid base URL: ${e}. Please provide a valid base URL.`,String(t))}}(e),function(e){try{return"/"!==(new URL(e).pathname.replace(/\/+$/,"")||"/")}catch{throw new S(`Invalid base URL: ${e}. Please provide a valid base URL.`)}}(e))return e;let n=e.replace(/\/+$/,"");return t&&"/"!==t?(t=t.startsWith("/")?t:`/${t}`,`${n}${t}`):n}let A={id:"redirect",name:"Redirect",hooks:{onSuccess(e){if(e.data?.url&&e.data?.redirect&&"undefined"!=typeof window&&window.location&&window.location)try{window.location.href=e.data.url}catch{}}}},I={proto:/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,constructor:/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,protoShort:/"__proto__"\s*:/,constructorShort:/"constructor"\s*:/},x=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/,P={true:!0,false:!1,null:null,undefined:void 0,nan:NaN,infinity:Number.POSITIVE_INFINITY,"-infinity":Number.NEGATIVE_INFINITY},C=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})(?:\.(\d{1,7}))?(?:Z|([+-])(\d{2}):(\d{2}))$/,U=[],j=0,N=0,M=e=>{let t=[],n={get:()=>(n.lc||n.listen(()=>{})(),n.value),lc:0,listen:e=>(n.lc=t.push(e),()=>{for(let t=j+4;t<U.length;)U[t]===e?U.splice(t,4):t+=4;let r=t.indexOf(e);!~r||(t.splice(r,1),--n.lc||n.off())}),notify(e,r){N++;let o=!U.length;for(let o of t)U.push(o,n.value,e,r);if(o){for(j=0;j<U.length;j+=4)U[j](U[j+1],U[j+2],U[j+3]);U.length=0}},off(){},set(e){let t=n.value;t!==e&&(n.value=e,n.notify(t))},subscribe(e){let t=n.listen(e);return e(n.value),t},value:e};return n},k=(e,t,n,r)=>(e.events=e.events||{},e.events[n+10]||(e.events[n+10]=r(t=>{e.events[n].reduceRight((e,t)=>(t(e),e),{shared:{},...t})})),e.events[n]=e.events[n]||[],e.events[n].push(t),()=>{let r=e.events[n],o=r.indexOf(t);r.splice(o,1),r.length||(delete e.events[n],e.events[n+10](),delete e.events[n+10])}),$=(e,t)=>k(e,n=>{let r=t(n);r&&e.events[6].push(r)},5,t=>{let n=e.listen;e.listen=(...r)=>(e.lc||e.active||(e.active=!0,t()),n(...r));let r=e.off;return e.events[6]=[],e.off=()=>{r(),setTimeout(()=>{if(e.active&&!e.lc){for(let t of(e.active=!1,e.events[6]))t();e.events[6]=[]}},1e3)},()=>{e.listen=n,e.off=r}}),B=()=>"undefined"==typeof window,D=(e,t,n,r)=>{let o=M({data:null,error:null,isPending:!0,isRefetching:!1,refetch:e=>i(e)}),i=async e=>new Promise(i=>{let s="function"==typeof r?r({data:o.get().data,error:o.get().error,isPending:o.get().isPending}):r;n(t,{...s,query:{...s?.query,...e?.query},async onSuccess(e){o.set({data:e.data,error:null,isPending:!1,isRefetching:!1,refetch:o.value.refetch}),await s?.onSuccess?.(e)},async onError(e){let{request:t}=e,n="number"==typeof t.retry?t.retry:t.retry?.attempts,r=t.retryAttempt||0;n&&r<n||(o.set({error:e.error,data:null,isPending:!1,isRefetching:!1,refetch:o.value.refetch}),await s?.onError?.(e))},async onRequest(e){let t=o.get();o.set({isPending:null===t.data,data:t.data,error:null,isRefetching:!0,refetch:o.value.refetch}),await s?.onRequest?.(e)}}).catch(e=>{o.set({error:e,data:null,isPending:!1,isRefetching:!1,refetch:o.value.refetch})}).finally(()=>{i(void 0)})});e=Array.isArray(e)?e:[e];let s=!1;for(let t of e)t.subscribe(async()=>{B()||(s?await i():$(o,()=>{let e=setTimeout(async()=>{s||(await i(),s=!0)},0);return()=>{o.off(),t.off(),clearTimeout(e)}}))});return o};var q=Object.defineProperty,F=Object.defineProperties,H=Object.getOwnPropertyDescriptors,V=Object.getOwnPropertySymbols,G=Object.prototype.hasOwnProperty,W=Object.prototype.propertyIsEnumerable,Y=(e,t,n)=>t in e?q(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,K=(e,t)=>{for(var n in t||(t={}))G.call(t,n)&&Y(e,n,t[n]);if(V)for(var n of V(t))W.call(t,n)&&Y(e,n,t[n]);return e},J=(e,t)=>F(e,H(t)),z=class extends Error{constructor(e,t,n){super(t||e.toString(),{cause:n}),this.status=e,this.statusText=t,this.error=n,Error.captureStackTrace(this,this.constructor)}},X=async(e,t)=>{var n,r,o,i,s,l;let u=t||{},a={onRequest:[null==t?void 0:t.onRequest],onResponse:[null==t?void 0:t.onResponse],onSuccess:[null==t?void 0:t.onSuccess],onError:[null==t?void 0:t.onError],onRetry:[null==t?void 0:t.onRetry]};if(!t||!(null==t?void 0:t.plugins))return{url:e,options:u,hooks:a};for(let c of(null==t?void 0:t.plugins)||[]){if(c.init){let r=await (null==(n=c.init)?void 0:n.call(c,e.toString(),t));u=r.options||u,e=r.url}a.onRequest.push(null==(r=c.hooks)?void 0:r.onRequest),a.onResponse.push(null==(o=c.hooks)?void 0:o.onResponse),a.onSuccess.push(null==(i=c.hooks)?void 0:i.onSuccess),a.onError.push(null==(s=c.hooks)?void 0:s.onError),a.onRetry.push(null==(l=c.hooks)?void 0:l.onRetry)}return{url:e,options:u,hooks:a}},Z=class{constructor(e){this.options=e}shouldAttemptRetry(e,t){return this.options.shouldRetry?Promise.resolve(e<this.options.attempts&&this.options.shouldRetry(t)):Promise.resolve(e<this.options.attempts)}getDelay(){return this.options.delay}},Q=class{constructor(e){this.options=e}shouldAttemptRetry(e,t){return this.options.shouldRetry?Promise.resolve(e<this.options.attempts&&this.options.shouldRetry(t)):Promise.resolve(e<this.options.attempts)}getDelay(e){return Math.min(this.options.maxDelay,this.options.baseDelay*2**e)}},ee=async e=>{let t={},n=async e=>"function"==typeof e?await e():e;if(null==e?void 0:e.auth){if("Bearer"===e.auth.type){let r=await n(e.auth.token);if(!r)return t;t.authorization=`Bearer ${r}`}else if("Basic"===e.auth.type){let[r,o]=await Promise.all([n(e.auth.username),n(e.auth.password)]);if(!r||!o)return t;t.authorization=`Basic ${btoa(`${r}:${o}`)}`}else if("Custom"===e.auth.type){let[r,o]=await Promise.all([n(e.auth.prefix),n(e.auth.value)]);if(!o)return t;t.authorization=`${null!=r?r:""} ${o}`}}return t},et=/^application\/(?:[\w!#$%&*.^`~-]*\+)?json(;.+)?$/i;function en(e){if(void 0===e)return!1;let t=typeof e;return"string"===t||"number"===t||"boolean"===t||null===t||"object"===t&&(!!Array.isArray(e)||!e.buffer&&(e.constructor&&"Object"===e.constructor.name||"function"==typeof e.toJSON))}function er(e){try{return JSON.parse(e)}catch(t){return e}}function eo(e){return"function"==typeof e}async function ei(e){let t=new Headers(null==e?void 0:e.headers);for(let[n,r]of Object.entries(await ee(e)||{}))t.set(n,r);if(!t.has("content-type")){let n=en(null==e?void 0:e.body)?"application/json":null;n&&t.set("content-type",n)}return t}var es=class e extends Error{constructor(t,n){super(n||JSON.stringify(t,null,2)),this.issues=t,Object.setPrototypeOf(this,e.prototype)}};async function el(e,t){let n=await e["~standard"].validate(t);if(n.issues)throw new es(n.issues);return n.value}var eu=["get","post","put","patch","delete"],ea=e=>({id:"apply-schema",name:"Apply Schema",version:"1.0.0",async init(t,n){var r,o,i,s;let l=(null==(o=null==(r=e.plugins)?void 0:r.find(e=>{var n;return null!=(n=e.schema)&&!!n.config&&(t.startsWith(e.schema.config.baseURL||"")||t.startsWith(e.schema.config.prefix||""))}))?void 0:o.schema)||e.schema;if(l){let e=t;(null==(i=l.config)?void 0:i.prefix)&&e.startsWith(l.config.prefix)&&(e=e.replace(l.config.prefix,""),l.config.baseURL&&(t=t.replace(l.config.prefix,l.config.baseURL))),(null==(s=l.config)?void 0:s.baseURL)&&e.startsWith(l.config.baseURL)&&(e=e.replace(l.config.baseURL,""));let r=l.schema[e];if(r){let e=J(K({},n),{method:r.method,output:r.output});return(null==n?void 0:n.disableValidation)||(e=J(K({},e),{body:r.input?await el(r.input,null==n?void 0:n.body):null==n?void 0:n.body,params:r.params?await el(r.params,null==n?void 0:n.params):null==n?void 0:n.params,query:r.query?await el(r.query,null==n?void 0:n.query):null==n?void 0:n.query})),{url:t,options:e}}}return{url:t,options:n}}}),ec=e=>async function(t,n){let r=J(K(K({},e),n),{plugins:[...(null==e?void 0:e.plugins)||[],ea(e||{}),...(null==n?void 0:n.plugins)||[]]});if(null==e?void 0:e.catchAllError)try{return await ef(t,r)}catch(e){return{data:null,error:{status:500,statusText:"Fetch Error",message:"Fetch related error. Captured by catchAllError option. See error property for more details.",error:e}}}return await ef(t,r)},ef=async(e,t)=>{var n,r,o,i,s,l,u,a;let c;let{hooks:f,url:d,options:p}=await X(e,t),h=function(e){if(null==e?void 0:e.customFetchImpl)return e.customFetchImpl;if("undefined"!=typeof globalThis&&eo(globalThis.fetch))return globalThis.fetch;if("undefined"!=typeof window&&eo(window.fetch))return window.fetch;throw Error("No fetch implementation found")}(p),v=new AbortController,y=null!=(n=p.signal)?n:v.signal,b=function(e,t){let{baseURL:n,params:r,query:o}=t||{query:{},params:{},baseURL:""},i=e.startsWith("http")?e.split("/").slice(0,3).join("/"):n||"";if(e.startsWith("@")){let t=e.toString().split("@")[1].split("/")[0];eu.includes(t)&&(e=e.replace(`@${t}/`,"/"))}i.endsWith("/")||(i+="/");let[s,l]=e.replace(i,"").split("?"),u=new URLSearchParams(l);for(let[e,t]of Object.entries(o||{})){let n;if(null!=t){if("string"==typeof t)n=t;else if(Array.isArray(t)){for(let n of t)u.append(e,n);continue}else n=JSON.stringify(t);u.set(e,n)}}if(r){if(Array.isArray(r))for(let[e,t]of s.split("/").filter(e=>e.startsWith(":")).entries()){let n=r[e];s=s.replace(t,n)}else for(let[e,t]of Object.entries(r))s=s.replace(`:${e}`,String(t))}(s=s.split("/").map(encodeURIComponent).join("/")).startsWith("/")&&(s=s.slice(1));let a=u.toString();return(a=a.length>0?`?${a}`.replace(/\+/g,"%20"):"",i.startsWith("http"))?new URL(`${s}${a}`,i):`${i}${s}${a}`}(d,p),g=function(e){if(!(null==e?void 0:e.body))return null;let t=new Headers(null==e?void 0:e.headers);if(en(e.body)&&!t.has("content-type")){for(let[t,n]of Object.entries(null==e?void 0:e.body))n instanceof Date&&(e.body[t]=n.toISOString());return JSON.stringify(e.body)}return t.has("content-type")&&"application/x-www-form-urlencoded"===t.get("content-type")&&en(e.body)?new URLSearchParams(e.body).toString():e.body}(p),m=await ei(p),T=function(e,t){var n;if(null==t?void 0:t.method)return t.method.toUpperCase();if(e.startsWith("@")){let r=null==(n=e.split("@")[1])?void 0:n.split("/")[0];return eu.includes(r)?r.toUpperCase():(null==t?void 0:t.body)?"POST":"GET"}return(null==t?void 0:t.body)?"POST":"GET"}(d,p),w=J(K({},p),{url:b,headers:m,body:g,method:T,signal:y});for(let e of f.onRequest)if(e){let t=await e(w);"object"==typeof t&&null!==t&&(w=t)}("pipeTo"in w&&"function"==typeof w.pipeTo||"function"==typeof(null==(r=null==t?void 0:t.body)?void 0:r.pipe))&&!("duplex"in w)&&(w.duplex="half");let{clearTimeout:E}=(!(null==p?void 0:p.signal)&&(null==p?void 0:p.timeout)&&(c=setTimeout(()=>null==v?void 0:v.abort(),null==p?void 0:p.timeout)),{abortTimeout:c,clearTimeout:()=>{c&&clearTimeout(c)}}),R=await h(w.url,w);E();let O={response:R,request:w};for(let e of f.onResponse)if(e){let n=await e(J(K({},O),{response:(null==(o=null==t?void 0:t.hookOptions)?void 0:o.cloneResponse)?R.clone():R}));n instanceof Response?R=n:"object"==typeof n&&null!==n&&(R=n.response)}if(R.ok){if(!("HEAD"!==w.method))return{data:"",error:null};let e=function(e){let t=e.headers.get("content-type"),n=new Set(["image/svg","application/xml","application/xhtml","application/html"]);if(!t)return"json";let r=t.split(";").shift()||"";return et.test(r)?"json":n.has(r)||r.startsWith("text/")?"text":"blob"}(R),n={data:null,response:R,request:w};if("json"===e||"text"===e){let e=await R.text(),t=null!=(i=w.jsonParser)?i:er;n.data=await t(e)}else n.data=await R[e]();for(let e of((null==w?void 0:w.output)&&w.output&&!w.disableValidation&&(n.data=await el(w.output,n.data)),f.onSuccess))e&&await e(J(K({},n),{response:(null==(s=null==t?void 0:t.hookOptions)?void 0:s.cloneResponse)?R.clone():R}));return(null==t?void 0:t.throw)?n.data:{data:n.data,error:null}}let _=null!=(l=null==t?void 0:t.jsonParser)?l:er,S=await R.text(),L=function(e){try{return JSON.parse(e),!0}catch(e){return!1}}(S),A=L?await _(S):null,I={response:R,responseText:S,request:w,error:J(K({},A),{status:R.status,statusText:R.statusText})};for(let e of f.onError)e&&await e(J(K({},I),{response:(null==(u=null==t?void 0:t.hookOptions)?void 0:u.cloneResponse)?R.clone():R}));if(null==t?void 0:t.retry){let n=function(e){if("number"==typeof e)return new Z({type:"linear",attempts:e,delay:1e3});switch(e.type){case"linear":return new Z(e);case"exponential":return new Q(e);default:throw Error("Invalid retry strategy")}}(t.retry),r=null!=(a=t.retryAttempt)?a:0;if(await n.shouldAttemptRetry(r,R)){for(let e of f.onRetry)e&&await e(O);let o=n.getDelay(r);return await new Promise(e=>setTimeout(e,o)),await ef(e,J(K({},t),{retryAttempt:r+1}))}}if(null==t?void 0:t.throw)throw new z(R.status,R.statusText,L?A:S);return{data:null,error:J(K({},A),{status:R.status,statusText:R.statusText})}};let ed=(e,t)=>{let n="credentials"in Request.prototype,r=function(e,t,n,r,o){if(e)return L(e,t);if(!1!==r){let e=b.BETTER_AUTH_URL||b.NEXT_PUBLIC_BETTER_AUTH_URL||b.PUBLIC_BETTER_AUTH_URL||b.NUXT_PUBLIC_BETTER_AUTH_URL||b.NUXT_PUBLIC_AUTH_URL||("/"!==b.BASE_URL?b.BASE_URL:void 0);if(e)return L(e,t)}if(n?.headers.get("x-forwarded-host"),n?.headers.get("x-forwarded-proto"),n){let e=function(e){try{let t=new URL(e);return"null"===t.origin?null:t.origin}catch{return null}}(n.url);if(!e)throw new S("Could not get origin from request. Please provide a valid base URL.");return L(e,t)}if("undefined"!=typeof window&&window.location)return L(window.location.origin,t)}(e?.baseURL,e?.basePath,void 0,t)??"/api/auth",o=e?.plugins?.flatMap(e=>e.fetchPlugins).filter(e=>void 0!==e)||[],i={id:"lifecycle-hooks",name:"lifecycle-hooks",hooks:{onSuccess:e?.fetchOptions?.onSuccess,onError:e?.fetchOptions?.onError,onRequest:e?.fetchOptions?.onRequest,onResponse:e?.fetchOptions?.onResponse}},{onSuccess:l,onError:u,onRequest:c,onResponse:f,...h}=e?.fetchOptions||{},v=ec({baseURL:r,...n?{credentials:"include"}:{},method:"GET",jsonParser:e=>e?function(e,t={strict:!0}){return function(e,t={}){let{strict:n=!1,warnings:r=!1,reviver:o,parseDates:i=!0}=t;if("string"!=typeof e)return e;let s=e.trim();if(s.length>0&&'"'===s[0]&&s.endsWith('"')&&!s.slice(1,-1).includes('"'))return s.slice(1,-1);let l=s.toLowerCase();if(l.length<=9&&l in P)return P[l];if(!x.test(s)){if(n)throw SyntaxError("[better-json] Invalid JSON");return e}if(Object.entries(I).some(([e,t])=>{let n=t.test(s);return n&&r&&console.warn(`[better-json] Detected potential prototype pollution attempt using ${e} pattern`),n})&&n)throw Error("[better-json] Potential prototype pollution attempt detected");try{return JSON.parse(s,(e,t)=>{if("__proto__"===e||"constructor"===e&&t&&"object"==typeof t&&"prototype"in t){r&&console.warn(`[better-json] Dropping "${e}" key to prevent prototype pollution`);return}if(i&&"string"==typeof t){let e=function(e){let t=C.exec(e);if(!t)return null;let[,n,r,o,i,s,l,u,a,c,f]=t,d=new Date(Date.UTC(parseInt(n,10),parseInt(r,10)-1,parseInt(o,10),parseInt(i,10),parseInt(s,10),parseInt(l,10),u?parseInt(u.padEnd(3,"0"),10):0));if(a){let e=(60*parseInt(c,10)+parseInt(f,10))*("+"===a?-1:1);d.setUTCMinutes(d.getUTCMinutes()+e)}return d instanceof Date&&!isNaN(d.getTime())?d:null}(t);if(e)return e}return o?o(e,t):t})}catch(t){if(n)throw t;return e}}(e,t)}(e,{strict:!1}):null,customFetchImpl:fetch,...h,plugins:[i,...h.plugins||[],...e?.disableDefaultFetchPlugins?[]:[A],...o]}),{$sessionSignal:y,session:g}=function(e,t){let n=M(!1),r=D(n,"/get-session",e,{method:"GET"});return $(r,()=>{let o=function(e){let{sessionAtom:t,sessionSignal:n,$fetch:r,options:o={}}=e,i=o.sessionOptions?.refetchInterval??0,l=o.sessionOptions?.refetchOnWindowFocus??!0,u=o.sessionOptions?.refetchWhenOffline??!1,c={lastSync:0,lastSessionRequest:0,cachedSession:void 0},f=()=>u||d().isOnline,h=e=>{if(!f())return;if(e?.event==="storage"){c.lastSync=p(),n.set(!n.get());return}let o=t.get();if(e?.event==="poll"){c.lastSessionRequest=p(),r("/get-session").then(e=>{e.error?t.set({...o,data:null,error:e.error}):t.set({...o,data:e.data,error:null}),c.lastSync=p(),n.set(!n.get())}).catch(()=>{});return}e?.event==="visibilitychange"&&p()-c.lastSessionRequest<5&&o?.data!==null&&o?.data!==void 0||o?.data!==null&&o?.data!==void 0&&e?.event!=="visibilitychange"||(e?.event==="visibilitychange"&&(c.lastSessionRequest=p()),c.lastSync=p(),n.set(!n.get()))},v=()=>{i&&i>0&&(c.pollInterval=setInterval(()=>{t.get()?.data&&h({event:"poll"})},1e3*i))},y=()=>{c.unsubscribeBroadcast=s().subscribe(()=>{h({event:"storage"})})},b=()=>{l&&(c.unsubscribeFocus=a().subscribe(()=>{h({event:"visibilitychange"})}))},g=()=>{c.unsubscribeOnline=d().subscribe(e=>{e&&h({event:"visibilitychange"})})};return{init:()=>{v(),y(),b(),g(),s().setup(),a().setup(),d().setup()},cleanup:()=>{c.pollInterval&&(clearInterval(c.pollInterval),c.pollInterval=void 0),c.unsubscribeBroadcast&&(c.unsubscribeBroadcast(),c.unsubscribeBroadcast=void 0),c.unsubscribeFocus&&(c.unsubscribeFocus(),c.unsubscribeFocus=void 0),c.unsubscribeOnline&&(c.unsubscribeOnline(),c.unsubscribeOnline=void 0),c.lastSync=0,c.lastSessionRequest=0,c.cachedSession=void 0},triggerRefetch:h,broadcastSessionUpdate:e=>{s().post({event:"session",data:{trigger:e},clientId:Math.random().toString(36).substring(7)})}}}({sessionAtom:r,sessionSignal:n,$fetch:e,options:t});return o.init(),()=>{o.cleanup()}}),{session:r,$sessionSignal:n}}(v,e),m=e?.plugins||[],T={},w={$sessionSignal:y,session:g},E={"/sign-out":"POST","/revoke-sessions":"POST","/revoke-other-sessions":"POST","/delete-user":"POST"},R=[{signal:"$sessionSignal",matcher:e=>"/sign-out"===e||"/update-user"===e||"/sign-up/email"===e||"/sign-in/email"===e||"/delete-user"===e||"/verify-email"===e||"/revoke-sessions"===e||"/revoke-session"===e||"/change-email"===e}];for(let e of m)e.getAtoms&&Object.assign(w,e.getAtoms?.(v)),e.pathMethods&&Object.assign(E,e.pathMethods),e.atomListeners&&R.push(...e.atomListeners);let O={notify:e=>{w[e].set(!w[e].get())},listen:(e,t)=>{w[e].subscribe(t)},atoms:w};for(let t of m)t.getActions&&Object.assign(T,t.getActions?.(v,O,e));return{get baseURL(){return r},pluginsActions:T,pluginsAtoms:w,pluginPathMethods:E,atomListeners:R,$fetch:v,$store:O}};function ep(e){var t;let{pluginPathMethods:n,pluginsActions:r,pluginsAtoms:o,$fetch:i,atomListeners:s,$store:l}=ed(e),u={};for(let[e,t]of Object.entries(o))u[`use${e.charAt(0).toUpperCase()+e.slice(1)}`]=t;return t={...r,...u,$fetch:i,$store:l},function e(r=[]){return new Proxy(function(){},{get(n,o){var i;if("string"!=typeof o||"then"===o||"catch"===o||"finally"===o)return;let s=[...r,o],l=t;for(let e of s)if(l&&"object"==typeof l&&e in l)l=l[e];else{l=void 0;break}return"function"==typeof l?l:"object"==typeof(i=l)&&null!==i&&"get"in i&&"function"==typeof i.get&&"lc"in i&&"number"==typeof i.lc?l:e(s)},apply:async(e,t,l)=>{let u="/"+r.map(e=>e.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)).join("/"),a=l[0]||{},c=l[1]||{},{query:f,fetchOptions:d,...p}=a,h={...c,...d},v=function(e,t,n){let r=t[e],{fetchOptions:o,query:i,...s}=n||{};return r||(o?.method?o.method:s&&Object.keys(s).length>0?"POST":"GET")}(u,n,a);return await i(u,{...h,body:"GET"===v?void 0:{...p,...h?.body||{}},query:f||h?.query,method:v,async onSuccess(e){if(await h?.onSuccess?.(e),!s||h.disableSignal)return;let t=s.filter(e=>e.matcher(u));if(t.length)for(let e of t){let t=o[e.signal];if(!t)return;let n=t.get();setTimeout(()=>{t.set(!n)},10)}}})}})}()}}}]);